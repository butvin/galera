user  nginx;
worker_processes  auto;

error_log  /var/log/nginx/error.log warn;
pid  /var/run/nginx.pid;

events {
    use  epoll;
    worker_connections  1024;
    multi_accept  on;
}

http {
    include  /etc/nginx/mime.types;
    default_type  application/octet-stream;

    access_log off;
    error_log  /var/log/nginx/error.log crit;

    log_format  main  '$remote_addr - $remote_user [$time_local] "$request" '
                        '$status $body_bytes_sent "$http_referer" '
                        '"$http_user_agent" "$http_x_forwarded_for"';

    access_log  /var/log/nginx/access.log  main;

    sendfile  on;
#     tcp_nodelay  on;
#     tcp_nopush  on;

    keepalive_timeout  60;
#     proxy_connect_timeout       15;
#     proxy_send_timeout          15;
#     send_timeout                15;
#     uwsgi_read_timeout          60;

    open_file_cache   max=200000 inactive=20s;
    open_file_cache_valid  30s;
    open_file_cache_min_uses  2;
    open_file_cache_errors  on;

    reset_timedout_connection on;
    client_max_body_size 256M;
    client_body_timeout 60;
    send_timeout 15;

    # This is the main geonode conf
#     charset  utf-8;

    # max upload size
#     client_body_buffer_size     256K;
#     large_client_header_buffers 4 64k;
#     proxy_read_timeout          60s;

    gzip  on;
    gzip_disable  "msie6";
    gzip_disable  "MSIE [1-6]\.";
    gzip_types
            text/plain
            text/css
            text/js
            text/xml
            text/javascript
            application/javascript
            application/x-javascript
            application/json
            application/xml
            application/rss+xml
            image/svg+xml;
    # ----------------------------------------------------------------------------------------
#     gzip_vary                   on;
#     gzip_proxied                any;
#     gzip_http_version           1.1;

#     gzip_buffers                16 8k;
#     gzip_min_length             1100;
#     gzip_comp_level             6;

    fastcgi_cache_path  /etc/nginx-cache levels=1:2 keys_zone=phpcache:100m inactive=60m;
    fastcgi_cache_key   "$scheme$request_method$host$request_uri";

    include /etc/nginx/conf.d/*.conf;
}

# types {
#   text/html                             html htm shtml;
#   text/css                              css;
#   text/xml                              xml rss;
#   image/gif                             gif;
#   image/jpeg                            jpeg jpg;
#   application/x-javascript              js;
#   text/plain                            txt;
#   text/x-component                      htc;
#   text/mathml                           mml;
#   image/png                             png;
#   image/x-icon                          ico;
#   image/x-jng                           jng;
#   image/vnd.wap.wbmp                    wbmp;
#   application/java-archive              jar war ear;
#   application/mac-binhex40              hqx;
#   application/pdf                       pdf;
#   application/x-cocoa                   cco;
#   application/x-java-archive-diff       jardiff;
#   application/x-java-jnlp-file          jnlp;
#   application/x-makeself                run;
#   application/x-perl                    pl pm;
#   application/x-pilot                   prc pdb;
#   application/x-rar-compressed          rar;
#   application/x-redhat-package-manager  rpm;
#   application/x-sea                     sea;
#   application/x-shockwave-flash         swf;
#   application/x-stuffit                 sit;
#   application/x-tcl                     tcl tk;
#   application/x-x509-ca-cert            der pem crt;
#   application/x-xpinstall               xpi;
#   application/zip                       zip;
#   application/octet-stream              deb;
#   application/octet-stream              bin exe dll;
#   application/octet-stream              dmg;
#   application/octet-stream              eot;
#   application/octet-stream              iso img;
#   application/octet-stream              msi msp msm;
#   audio/mpeg                            mp3;
#   audio/x-realaudio                     ra;
#   video/mpeg                            mpeg mpg;
#   video/quicktime                       mov;
#   video/x-flv                           flv;
#   video/x-msvideo                       avi;
#   video/x-ms-wmv                        wmv;
#   video/x-ms-asf                        asx asf;
#   video/x-mng                           mng;
# }